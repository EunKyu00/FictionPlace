<!DOCTYPE html>
<html lang="ko">
<head>
    <title>웹툰 회차 목록</title>
    <link rel="stylesheet" th:href="@{/CSS/Navber.css}">
    <link rel="stylesheet" href="/episode_list.css">
</head>
<body>
<div th:replace="~{navbar :: navbar}"></div>
<div class="content_wrap">
    <!-- 사이드바 -->
    <div class="sidebar">
        <div class="sidebar-item">
            <!-- 일반 사용자를 위한 링크 -->
            <a th:if="${session.loginUser != null}"
               th:href="@{/profile/user/{id}(id=${session.loginUser.id})}"
               class="sidebar-link">
                <span class="sidebar-icon">🏠</span> 프로필 홈
            </a>

            <!-- 회사 사용자를 위한 링크 -->
            <a th:if="${session.loginCompanyUser != null and session.loginCompanyUser.id != null}"
               th:href="@{/profile/company/{id}(id=${session.loginCompanyUser.id})}"
               class="sidebar-link">
                <span class="sidebar-icon">🏢</span> 회사 프로필 홈
            </a>
        </div>
        <div class="sidebar-item">
            <a th:href="@{/webtoon/create}" class="sidebar-link">
                <span class="sidebar-icon">✏️</span> 작품 등록
            </a>
        </div>
        <div class="sidebar-item">
            <a th:href="@{/my/webtoon}" class="sidebar-link">
                <span class="sidebar-icon">📋</span> 작품 관리
            </a>
        </div>
        <div class="sidebar-item">
            <a th:href="@{/my/favorite/webtoon}" class="sidebar-link">
                <span class="sidebar-icon">❤️</span> 관심 작품
            </a>
        </div>
        <div class="sidebar-item">
            <a th:href="@{/message/menu}" class="sidebar-link">
                <span class="sidebar-icon">✉️</span> 쪽지함
            </a>
        </div>
        <div class="sidebar-item">
            <a th:if="${session.loginUser != null}"
               th:href="@{/profile/user/{id}/modify(id=${session.loginUser.id})}" class="sidebar-link">
                <span class="sidebar-icon">🖊️</span> 정보 수정
            </a>
            <!-- 회사 사용자를 위한 링크 -->
            <a th:if="${session.loginCompanyUser != null and session.loginCompanyUser.id != null}"
               th:href="@{/profile/company/{id}(id=${session.loginCompanyUser.id})}" class="sidebar-link">
                <span class="sidebar-icon">🖊️</span> 정보 수정
            </a>
        </div>
    </div>
    <div class="list-number">
    <h1 th:text="${webtoon.title}"></h1> <!-- 웹툰 제목 출력 -->
    <img th:src="@{${webtoon.thumbnailImg}}" alt="웹툰 썸네일" class="webtoon-thumbnail"/>

    <h2>회차 목록</h2>
    <ul>
        <form th:action="@{/webtoon/episodes/mainpage}" method="post">
            <ul>
                <li th:each="episode : ${episodes}">
                    <a th:href="@{/webtoon/episode/{id}(id=${episode.id})}">
                        <img th:src="@{${episode.thumbnailImg}}" alt="썸네일 이미지" width="100" height="100"/>
                    </a>
                    <span th:text="${episode.title}"></span>
                    <span class="time" th:text="${#temporals.format(episode.createdDate, 'yyyy-MM-dd HH:mm')}"></span>

                    <!--수정버튼-->
                    <a class="modify-btn"
                       th:href="@{/webtoon/episode/modify/{id}(id=${episode.id})}">
                        수정
                    </a>

                    <!-- 삭제 버튼 -->
                    <a class="delete-btn"
                       th:href="@{/webtoon/episode/delete/{id}(id=${episode.id})}"
                       onclick="return confirm('삭제하시겠습니까?');">
                        삭제
                    </a>
                    <!-- 체크박스 추가: 이미 선택된 회차인지 확인 -->
                    <input type="checkbox" th:name="selectedEpisodes" th:value="${episode.id}"
                           th:checked="${episode.selected}"/>
                </li>
            </ul>

            <!-- 웹툰 ID를 hidden 필드로 추가 -->
            <input type="hidden" th:name="webtoonId" th:value="${webtoon.id}"/>
            <!-- 메인 페이지에 등록 버튼 -->
            <button type="submit">선택된 회차 메인 페이지 등록</button>
        </form>
    </ul>

    <!-- 회차 추가 버튼 -->
    <a th:href="@{/webtoon/episodes/create/{id}(id=${webtoon.id})}">
        <button>신규 회차 등록</button>
    </a>
</div>
</div>
</body>
</html>
