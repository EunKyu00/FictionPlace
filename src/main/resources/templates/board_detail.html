<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>게시글 상세</title>
    <link rel="stylesheet" href="/board_detail.css">
</head>
<body>
<!-- 게시글 내용 -->
<h1 th:text="${board.title}"></h1>
<p th:text="${board.content}"></p>

<!-- 댓글 입력 폼 -->
<form th:action="@{|/comment/create/${board.id}|}" method="post">

    <!-- 로그인되지 않았을 때 에러 메시지 출력 -->
    <div th:if="${message}" style="color: red !important; margin-bottom: 20px;">
        <p th:text="${message}"></p>
    </div>
    <!-- 내용이 비었을 때 에러 메시지 출력 -->
    <div th:if="${errorContent}" style="color: red !important; margin-bottom: 20px;">
        <p th:text="${errorContent}"></p>
    </div>

    <textarea name="content" id="content" rows="10"></textarea>
    <input type="submit" value="댓글등록">
</form>

<!-- 게시글 수정/삭제 버튼 -->
<div th:if="${isAuthor}">
    <a th:href="@{|/board/modify/${board.id}|}" >수정하기</a>
    <a th:href="@{|/board/delete/${board.id}|}" style="color: red;">삭제하기</a>
</div>

<!-- 댓글 목록 출력 -->
<h2>댓글 목록</h2>
<ul>
    <li th:each="comment : ${comments}">
        <!-- 댓글 내용 -->
        <p th:text="${comment.content}"></p>

        <!-- 댓글 작성일 -->
        <p>작성일: <span th:text="${#temporals.format(comment.createdDate, 'yyyy-MM-dd HH:mm')}"></span></p>

        <!-- 댓글 작성자 -->
        <p>
            작성자:
            <span th:if="${comment.siteUser != null}" th:text="${comment.siteUser.nickname}"></span>
            <span th:if="${comment.companyUser != null}" th:text="${comment.companyUser.companyName}"></span>
        </p>

        <!-- 삭제 버튼 작성자만 보임 -->
        <div th:if="${loginUser != null && comment.siteUser?.id == loginUser?.id || loginCompanyUser != null && comment.companyUser?.id == loginCompanyUser?.id}">
            <a th:href="@{|/comment/delete/${comment.id}|}" style="color: red;">댓글 삭제</a>
        </div>
    </li>
</ul>



</body>
</html>
